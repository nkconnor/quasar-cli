#!/usr/bin/env node

var
  command = require('commander'),
  watch = require('gulp-watch'),
  server = require('browser-sync'),
  log = require('../lib/log')

command
  .usage('[folder]')
  .option('-p, --port <n>', 'port for asset serving', parseInt)
  .on('--help', function () {
    log('  Examples:')
    log()
    log('    # serve current folder'.gray)
    log('    $ quasar serve')
    log()
    log('    # serve specific folder'.gray)
    log('    $ quasar serve ./dist')
    log('    $ quasar serve /work/quasar-app/dist --port 5050')
  })
  .action(function(commandDir, options){
      var folder = commandDir || process.cwd()
      var port = options.port || 3000
      server.create().init({
          port: port,
          open: false,
          reloadOnRestart: true,
          ghostMode: false,
          server: {
              baseDir: folder
          }
      })

      watch(folder + '/**/*', function () {
          server.reload()
      })
  })
  .parse(process.argv)
